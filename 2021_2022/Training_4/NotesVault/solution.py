import base64

token = "YTRhYzM2ZDNhODdjZTEKMTcwMGY0YmQxYTFlZjcxOWJlM2U5NWViOTkzODNlMzZmZmQyOGEwNjA5NzIyMGMxYWRiNWMxN2U2ZmI2MzBlZTZiNTk2NzE2NDYzMTQwZmNiNzQ3NWUzZGViYWU5ZjIyOTUxZGZhZTk5YWRhZjQ1ZjljMzk3YmI2ODI2MWJlNTMwNzY0MTczNTMxNWRhYjA3ZGY1OTRjYTNhYmQ1ZjQ5MjcxMTg2ZGRmMGJjMWMyMTU4M2FkNWY0MjRmMmVhN2RhNjUyZGE1ZjkzNjEwY2IzZGU3M2M3OTkyMWI0OWM2ZDVlZGFiYWYzM2UyYjJhYTdiNGUwMDQ3MGVhNjdmMThkODdkYTE3NGIxMjY5MGRkYzdkOGQ3YTllMjI4N2ZhZmMyYWY0NTEwNWMyZGJkODYyOWY0NWIwMDBiZWJmOTljMTg4NTc4ZjMxYjZiNjFiODAwYWMyNmQzZDMyZWFiM2I2NjRlOTRkMDQ2YmVhNDk0YjA2MWY3YTY1NTI4YzI0OTEzOTUwZDRkYThlNjg4OTg0YWM5NmJlOTViYzg0NWMyNzU3YTZmMWFkZTY3YjU0OTI1MDMwOTRjMWY2MzZhYTI5MGUzMGMzZGFiYzViNDFjYzcyMWU5YWQwY2FkOGM0YTgxOTk0OWRlYTk5NDE4MzJhMjM3ZGMzMGVjNjRmNjIwY2I="
adminSecret = 0xdeadbeef
n = 0x88947242ed41dc41ddbc6402717ab9b6d829d38f026fe5790a65e3300223b9fbeaf9b6a1c3ab0386b2c915cbe2caf3c417bfb0d75737845888e37c2745cb1814bf6e76aadf6a64e98037465f7608f57cd55ca3f355d234bca0ed71d8a37584d65aa99fddba64e38035d78dca83453543a92d1eedc153573bc13245c2601ac1e01ea54cbb1be6259883a77e8b01aea24672356a07b852dafb8a181e612504aa7e8024f005bdb570fd2a8b1026eae9d819cc494643806b7105bac3f69c2a1db7e177540b005f00ecb94aebfdfe0c6a35bba5a250e8843013fca75b4d98fcb947f9b970b505672168a3c5870fa02277bcc1ee023916b3653063cf0efa63c8fe9363
e = 0x10001

decodedToken = base64.b64decode(token).decode().split("\n")
secret = int(decodedToken[0], 16)
token = int(decodedToken[1], 16)

invertedSecret = pow(secret, -1, n)
newToken = hex(pow(adminSecret, e, n) * (pow(invertedSecret, e, n) * token) % n)[2:]
newToken = hex(adminSecret)[2:] + "\n" + newToken
encodedNewToken = base64.b64encode(newToken.encode()).decode()
print(encodedNewToken)

